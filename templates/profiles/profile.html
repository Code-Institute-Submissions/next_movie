{% extends '_base.html' %}

{% load static %}

{% block title %}Profile{% endblock title %}

{% block content %}

<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>

<div class="email">Email address: {{profile.user.email}}</div>
<div class="watched-movies-average-rating">Average rating of watched movies: {{profile.watched_movies_average_rating}}</div>
<div class="watched-movies-genres-chart" id='watchedMoviesGenreChart'></div>
<div class="watched-movies-years-chart" id='watchedMoviesYearChart'></div>


<script src='{% static "js/profile_charts.js" %}'></script>

<script>
    try {
        let watched_genres = JSON.parse("{{profile.watched_movies_genres}}".replaceAll(`&#x27;`, `"`))
        let data = getWatchedMoviesGenreChartData(watched_genres)

        let layout = {
            margin: { l: 0, r: 0, b: 0, t: 0 },
            width: 500,
            height: 500
        };

        Plotly.newPlot('watchedMoviesGenreChart', data, layout);

    } catch (error) {
        console.warn(`Unable to generate watchedMoviesGenreChart. Error detail: {error}`)
    }

</script>

{% endblock content %}
